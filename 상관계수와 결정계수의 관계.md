### 결정계수 (\(R^2\))와 상관계수 (\(r\))의 관계

결정계수 (\(R^2\))와 상관계수 (\(r\))는 모두 데이터 간의 관계를 나타내는 지표이지만, 사용하는 상황과 의미는 약간 다릅니다. 두 지표는 **단순선형회귀**(독립변수가 1개인 경우)에서 아래와 같은 관계를 가집니다:

\[
R^2 = r^2
\]

즉, 결정계수는 상관계수의 제곱입니다. 이를 통해 두 개념의 연결점을 이해할 수 있습니다.

---

### 1. **상관계수 (\(r\))**

- **정의**: 두 변수 간의 선형적인 관계의 강도와 방향을 나타냅니다.
- **범위**: \(-1 \leq r \leq 1\)
  - \(r > 0\): 양의 상관관계 (한 변수가 증가하면 다른 변수도 증가).
  - \(r < 0\): 음의 상관관계 (한 변수가 증가하면 다른 변수는 감소).
  - \(r = 0\): 두 변수 간에 선형 관계가 없음.

상관계수는 다음 공식으로 계산됩니다:
\[
r = \frac{\text{Cov}(X, Y)}{\sigma_X \cdot \sigma_Y}
\]
- \(\text{Cov}(X, Y)\): 두 변수의 공분산
- \(\sigma_X\), \(\sigma_Y\): 각각 \(X\)와 \(Y\)의 표준편차

---

### 2. **결정계수 (\(R^2\))**

- **정의**: 회귀모델에서 독립변수가 종속변수의 변동성을 얼마나 잘 설명하는지를 나타냅니다.
- **범위**: \(0 \leq R^2 \leq 1\)
  - \(R^2 = 1\): 독립변수가 종속변수를 완벽히 설명.
  - \(R^2 = 0\): 독립변수가 종속변수의 변동성을 전혀 설명하지 못함.

결정계수는 다음 공식으로 계산됩니다:
\[
R^2 = 1 - \frac{\text{SSE}}{\text{SST}}
\]
- \(SSE\): 잔차제곱합 (Sum of Squared Errors)
- \(SST\): 총제곱합 (Total Sum of Squares)

---

### 3. **단순선형회귀에서의 관계 (\(R^2 = r^2\))**

단순선형회귀에서는 상관계수의 제곱이 결정계수와 동일합니다. 이는 두 값이 다음과 같은 방식으로 연결되기 때문입니다:
1. 상관계수 (\(r\))는 \(X\)와 \(Y\) 간의 선형적 관계를 나타냅니다.
2. 단순선형회귀에서는 종속변수 \(Y\)를 독립변수 \(X\)로만 설명하기 때문에, \(R^2\)는 \(X\)와 \(Y\) 간의 선형적 관계를 반영합니다.
3. 따라서, \(R^2 = r^2\)가 성립합니다.

---

### 4. **다중회귀분석에서의 관계**

- **다중회귀**에서는 \(R^2\)와 상관계수 \(r\)가 동일하지 않습니다.
- 이유:
  - 다중회귀에서는 여러 독립변수가 종속변수에 미치는 영향을 설명합니다.
  - \(R^2\)는 독립변수들의 결합된 설명력을 나타내며, 개별 독립변수와 종속변수 간의 단순 상관관계로 표현되지 않습니다.

---

### 5. **예제: 단순선형회귀와 다중회귀에서의 \(R^2\)와 \(r\)**

#### (1) 단순선형회귀
```python
import numpy as np
from sklearn.linear_model import LinearRegression
from scipy.stats import pearsonr

# 데이터 생성
np.random.seed(0)
x = np.random.rand(100, 1)
y = 2 * x.flatten() + np.random.randn(100) * 0.1

# 회귀 분석
model = LinearRegression()
model.fit(x, y)
r_squared = model.score(x, y)  # R^2 계산

# 상관계수 계산
r, _ = pearsonr(x.flatten(), y)

print(f"R^2: {r_squared:.4f}")
print(f"r^2: {r**2:.4f}")
```

**결과**:
- \(R^2\)와 \(r^2\)는 동일.

#### (2) 다중회귀
```python
# 다중회귀 데이터 생성
x_multi = np.random.rand(100, 2)  # 두 개의 독립변수
y_multi = 3 * x_multi[:, 0] + 2 * x_multi[:, 1] + np.random.randn(100) * 0.1

# 회귀 분석
model_multi = LinearRegression()
model_multi.fit(x_multi, y_multi)
r_squared_multi = model_multi.score(x_multi, y_multi)

print(f"R^2 (다중회귀): {r_squared_multi:.4f}")
```

- 다중회귀에서는 \(R^2\)는 모든 독립변수의 결합된 설명력을 나타내므로, 상관계수 \(r\)와의 관계가 없습니다.

---

### 6. **요약**
- **단순선형회귀**: \(R^2 = r^2\)
- **다중회귀**: \(R^2\)는 여러 독립변수의 결합된 설명력을 나타내며, 개별 상관계수와 직접적인 관계가 없습니다.
- \(R^2\)는 종속변수의 설명력을 평가, \(r\)는 두 변수 간의 선형적 관계를 측정하는 데 사용됩니다.